<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta name="referrer" content="never">
<meta name="keywords" content="">
<meta name="description" content="欢迎访问[tianxia]的个人博客">
<meta name="author" content="kveln">
<title>easyExcel | tianxia</title>
<link rel="stylesheet" href="https://tinaxiawuhao.github.io/resource/bootstrap.min.css">
<link href="https://tinaxiawuhao.github.io/resource/all.min.css" rel="stylesheet">
<link rel="alternate" type="application/rss+xml" title="easyExcel | tianxia » Feed"
  href="https://tinaxiawuhao.github.io/atom.xml">
<link rel="stylesheet"
  href="https://tinaxiawuhao.github.io/resource/androidstudio.min.css">
<link href="https://tinaxiawuhao.github.io/styles/main.css" rel="stylesheet">
<script src="https://tinaxiawuhao.github.io/resource/jquery.min.js"></script>

<script src="https://tinaxiawuhao.github.io/resource/highlight.min.js"></script>

<link rel="stylesheet" href="https://tinaxiawuhao.github.io/resource/live2d.css">

<script>hljs.initHighlightingOnLoad();</script>

  <meta property="og:description" content="easyExcel" />
  <meta property="og:url" content="https://tinaxiawuhao.github.io/post/T8lb37RDN/" />
  <meta property="og:locale" content="zh-CN" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="tianxia" />
  <!-- <script src="../assets/styles/scripts/tocScript.js"></script> -->
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://tinaxiawuhao.github.io">tianxia</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="/">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/archives">归档</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/tags">标签</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/post/about">关于</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1663068709855"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <!-- Page Header -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://tinaxiawuhao.github.io">tianxia</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="/">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/archives">归档</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/tags">标签</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/post/about">关于</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1663068709855"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
<header class="masthead" style="background-image: url('https://tinaxiawuhao.github.io/media/images/home-bg.jpg')">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        
          <!-- 没Title为其他页面Header -->
          
            <!-- 没Title并且有headerType为Post：文章Header -->
            <div class="post-heading">
              <span class="tags">
                
                <a href="https://tinaxiawuhao.github.io/tag/caYvGLLJl/" class="tag">excel</a>
                
              </span>
              <h1>easyExcel</h1>
              <span class="meta">
                Posted on
                2022-03-10，22 min read
              </span>
            </div>
          
        
      </div>
    </div>
  </div>
</header>
  <!-- Post Content -->
  <article id="post-content-article">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto post-content-container">
          
          <img class="post-feature-header-image" src="https://tinaxiawuhao.github.io/post-images/T8lb37RDN.png" alt="封面图">
          </img>
          
          <h3 id="读excel">读Excel</h3>
<h4 id="注解">注解</h4>
<p>使用注解很简单，只要在对应的实体类上面加上注解即可。</p>
<h5 id="excelproperty"><code>ExcelProperty</code></h5>
<p>用于匹配excel和实体类的匹配,参数如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>空</td>
<td>用于匹配excel中的头，必须全匹配,如果有多行头，会匹配最后一行头</td>
</tr>
<tr>
<td>order</td>
<td>Integer.MAX_VALUE</td>
<td>优先级高于<code>value</code>，会根据<code>order</code>的顺序来匹配实体和excel中数据的顺序</td>
</tr>
<tr>
<td>index</td>
<td>-1</td>
<td>优先级高于<code>value</code>和<code>order</code>，会根据<code>index</code>直接指定到excel中具体的哪一列</td>
</tr>
<tr>
<td>converter</td>
<td>自动选择</td>
<td>指定当前字段用什么转换器，默认会自动选择。读的情况下只要实现<code>com.alibaba.excel.converters.Converter#convertToJavaData(com.alibaba.excel.converters.ReadConverterContext&lt;?&gt;)</code> 方法即可</td>
</tr>
</tbody>
</table>
<h5 id="excelignore"><code>ExcelIgnore</code></h5>
<p>默认所有字段都会和excel去匹配，加了这个注解会忽略该字段</p>
<h5 id="excelignoreunannotated"><code>ExcelIgnoreUnannotated</code></h5>
<p>默认不加<code>ExcelProperty</code> 的注解的都会参与读写，加了不会参与</p>
<h5 id="datetimeformat"><code>DateTimeFormat</code></h5>
<p>日期转换，用<code>String</code>去接收excel日期格式的数据会调用这个注解,参数如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>空</td>
<td>参照<code>java.text.SimpleDateFormat</code>书写即可</td>
</tr>
<tr>
<td>use1904windowing</td>
<td>自动选择</td>
<td>excel中时间是存储1900年起的一个双精度浮点数，但是有时候默认开始日期是1904，所以设置这个值改成默认1904年开始</td>
</tr>
</tbody>
</table>
<h5 id="numberformat"><code>NumberFormat</code></h5>
<p>数字转换，用<code>String</code>去接收excel数字格式的数据会调用这个注解。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>空</td>
<td>参照<code>java.text.DecimalFormat</code>书写即可</td>
</tr>
<tr>
<td>roundingMode</td>
<td>RoundingMode.HALF_UP</td>
<td>格式化的时候设置舍入模式</td>
</tr>
</tbody>
</table>
<h4 id="参数">参数</h4>
<h5 id="概念介绍">概念介绍</h5>
<ul>
<li><code>ReadWorkbook</code> 可以理解成一个excel</li>
<li><code>ReadSheet</code> 理解成一个excel里面的一个表单</li>
</ul>
<h5 id="通用参数">通用参数</h5>
<p><code>ReadWorkbook</code>,<code>ReadSheet</code> 都会有的参数，如果为空，默认使用上级。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>converter</td>
<td>空</td>
<td>默认加载了很多转换器，这里可以加入不支持的字段</td>
</tr>
<tr>
<td>readListener</td>
<td>空</td>
<td>可以注册多个监听器，读取excel的时候会不断的回调监听器中的方法</td>
</tr>
<tr>
<td>headRowNumber</td>
<td>1</td>
<td>excel中头的行数，默认1行</td>
</tr>
<tr>
<td>head</td>
<td>空</td>
<td>与<code>clazz</code>二选一。读取文件头对应的列表，会根据列表匹配数据，建议使用class</td>
</tr>
<tr>
<td>clazz</td>
<td>空</td>
<td>与<code>head</code>二选一。读取文件的头对应的class，也可以使用注解。如果两个都不指定，则会读取全部数据</td>
</tr>
<tr>
<td>autoTrim</td>
<td>true</td>
<td>会对头、读取数据等进行自动trim</td>
</tr>
<tr>
<td>use1904windowing</td>
<td>false</td>
<td>excel中时间是存储1900年起的一个双精度浮点数，但是有时候默认开始日期是1904，所以设置这个值改成默认1904年开始</td>
</tr>
<tr>
<td>useScientificFormat</td>
<td>false</td>
<td>数字转文本的时候在较大的数值的是否是否采用科学计数法</td>
</tr>
</tbody>
</table>
<h5 id="readworkbook">ReadWorkbook</h5>
<p>设置方法如下，找不到参数的看下通用参数里面是否存在。</p>
<pre><code class="language-java"> EasyExcel.read(fileName, DemoData.class, new DemoDataListener())
 // 在 read 方法之后， 在 sheet方法之前都是设置ReadWorkbook的参数
 .sheet()
 .doRead();
</code></pre>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>excelType</td>
<td>空</td>
<td>当前excel的类型,支持XLS、XLSX、CSV</td>
</tr>
<tr>
<td>inputStream</td>
<td>空</td>
<td>与<code>file</code>二选一。读取文件的流，如果接收到的是流就只用，不用流建议使用<code>file</code>参数。因为使用了<code>inputStream</code> easyexcel会帮忙创建临时文件，最终还是<code>file</code></td>
</tr>
<tr>
<td>file</td>
<td>空</td>
<td>与<code>inputStream</code>二选一。读取文件的文件。</td>
</tr>
<tr>
<td>mandatoryUseInputStream</td>
<td>false</td>
<td>强制使用 <code>inputStream</code> 来创建对象，性能会变差，但是不会创建临文件。</td>
</tr>
<tr>
<td>charset</td>
<td>Charset#defaultCharset</td>
<td>只有csv文件有用，读取文件的时候使用的编码</td>
</tr>
<tr>
<td>autoCloseStream</td>
<td>true</td>
<td>自动关闭读取的流。</td>
</tr>
<tr>
<td>readCache</td>
<td>空</td>
<td>默认小于5M用 内存，超过5M会使用 <code>EhCache</code>,这里不建议使用这个参数。</td>
</tr>
<tr>
<td>readCacheSelector</td>
<td>SimpleReadCacheSelector</td>
<td>用于选择什么时候用内存去存储临时数据，什么时候用磁盘存储临时数据</td>
</tr>
<tr>
<td>ignoreEmptyRow</td>
<td>true</td>
<td>忽略空的行</td>
</tr>
<tr>
<td>password</td>
<td>空</td>
<td>读取文件的密码</td>
</tr>
<tr>
<td>xlsxSAXParserFactoryName</td>
<td>空</td>
<td>指定sax读取使用的class的名称，例如：<code>com.sun.org.apache.xerces.internal.jaxp.SAXParserFactoryImpl</code></td>
</tr>
<tr>
<td>useDefaultListener</td>
<td>true</td>
<td><code>@since 2.1.4</code> 默认会加入<code>ModelBuildEventListener</code> 来帮忙转换成传入<code>class</code>的对象，设置成<code>false</code>后将不会协助转换对象，自定义的监听器会接收到<code>Map&lt;Integer,CellData&gt;</code>对象，如果还想继续接听到<code>class</code>对象，请调用<code>readListener</code>方法，加入自定义的<code>beforeListener</code>、 <code>ModelBuildEventListener</code>、 自定义的<code>afterListener</code>即可。</td>
</tr>
<tr>
<td>extraReadSet</td>
<td>空</td>
<td>额外需要读取内容的set，默认不读取这些数据</td>
</tr>
</tbody>
</table>
<h5 id="readsheet">ReadSheet</h5>
<p>设置方法如下，找不到参数的看下通用参数里面是否存在。</p>
<pre><code class="language-java"> EasyExcel.read(fileName, DemoData.class, new DemoDataListener())
 .sheet()
  // 在 sheet 方法之后， 在 doRead方法之前都是设置ReadSheet的参数
 .doRead();
</code></pre>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sheetNo</td>
<td>0</td>
<td>需要读取Sheet的编码，建议使用这个来指定读取哪个Sheet</td>
</tr>
<tr>
<td>sheetName</td>
<td>空</td>
<td>根据名字去匹配Sheet</td>
</tr>
</tbody>
</table>
<h3 id="写excel">写Excel</h3>
<h4 id="注解-2">注解</h4>
<p>使用注解很简单，只要在对应的实体类上面加上注解即可。</p>
<h5 id="excelproperty-2"><code>ExcelProperty</code></h5>
<p>用于匹配excel和实体类的匹配,参数如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>空</td>
<td>用于匹配excel中的头，必须全匹配,如果有多行头，会匹配最后一行头</td>
</tr>
<tr>
<td>order</td>
<td>Integer.MAX_VALUE</td>
<td>优先级高于<code>value</code>，会根据<code>order</code>的顺序来匹配实体和excel中数据的顺序</td>
</tr>
<tr>
<td>index</td>
<td>-1</td>
<td>优先级高于<code>value</code>和<code>order</code>，会根据<code>index</code>直接指定到excel中具体的哪一列</td>
</tr>
<tr>
<td>converter</td>
<td>自动选择</td>
<td>指定当前字段用什么转换器，默认会自动选择。写的情况下只要实现<code>com.alibaba.excel.converters.Converter#convertToExcelData(com.alibaba.excel.converters.WriteConverterContext&lt;T&gt;)</code> 方法即可</td>
</tr>
</tbody>
</table>
<h5 id="excelignore-2"><code>ExcelIgnore</code></h5>
<p>默认所有字段都会和excel去匹配，加了这个注解会忽略该字段</p>
<h5 id="excelignoreunannotated-2"><code>ExcelIgnoreUnannotated</code></h5>
<p>默认不加<code>ExcelProperty</code> 的注解的都会参与读写，加了不会参与</p>
<h5 id="datetimeformat-2"><code>DateTimeFormat</code></h5>
<p>日期转换，用<code>String</code>去接收excel日期格式的数据会调用这个注解,参数如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>空</td>
<td>参照<code>java.text.SimpleDateFormat</code>书写即可</td>
</tr>
<tr>
<td>use1904windowing</td>
<td>自动选择</td>
<td>excel中时间是存储1900年起的一个双精度浮点数，但是有时候默认开始日期是1904，所以设置这个值改成默认1904年开始</td>
</tr>
</tbody>
</table>
<h5 id="numberformat-2"><code>NumberFormat</code></h5>
<p>数字转换，用<code>String</code>去接收excel数字格式的数据会调用这个注解。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>空</td>
<td>参照<code>java.text.DecimalFormat</code>书写即可</td>
</tr>
<tr>
<td>roundingMode</td>
<td>RoundingMode.HALF_UP</td>
<td>格式化的时候设置舍入模式</td>
</tr>
</tbody>
</table>
<h4 id="参数-2">参数</h4>
<h5 id="概念介绍-2">概念介绍</h5>
<ul>
<li><code>WriteWorkbook</code> 可以理解成一个excel</li>
<li><code>WriteSheet</code> 理解成一个excel里面的一个表单</li>
<li><code>WriteTable</code> 一个表单里面如果有多个实际用的表格，则可以用<code>WriteTable</code></li>
</ul>
<h5 id="通用参数-2">通用参数</h5>
<p><code>WriteWorkbook</code>,<code>WriteSheet</code> ,<code>WriteTable</code>都会有的参数，如果为空，默认使用上级。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>converter</td>
<td>空</td>
<td>默认加载了很多转换器，这里可以加入不支持的字段</td>
</tr>
<tr>
<td>writeHandler</td>
<td>空</td>
<td>写的处理器。可以实现<code>WorkbookWriteHandler</code>,<code>SheetWriteHandler</code>,<code>RowWriteHandler</code>,<code>CellWriteHandler</code>，在写入excel的不同阶段会调用</td>
</tr>
<tr>
<td>relativeHeadRowIndex</td>
<td>0</td>
<td>写入到excel和上面空开几行</td>
</tr>
<tr>
<td>head</td>
<td>空</td>
<td>与<code>clazz</code>二选一。读取文件头对应的列表，会根据列表匹配数据，建议使用class</td>
</tr>
<tr>
<td>clazz</td>
<td>空</td>
<td>与<code>head</code>二选一。读取文件的头对应的class，也可以使用注解。如果两个都不指定，则会读取全部数据</td>
</tr>
<tr>
<td>autoTrim</td>
<td>true</td>
<td>会对头、读取数据等进行自动trim</td>
</tr>
<tr>
<td>use1904windowing</td>
<td>false</td>
<td>excel中时间是存储1900年起的一个双精度浮点数，但是有时候默认开始日期是1904，所以设置这个值改成默认1904年开始</td>
</tr>
<tr>
<td>useScientificFormat</td>
<td>false</td>
<td>数字转文本的时候在较大的数值的是否是否采用科学计数法</td>
</tr>
<tr>
<td>needHead</td>
<td>true</td>
<td>是否需要写入头到excel</td>
</tr>
<tr>
<td>useDefaultStyle</td>
<td>true</td>
<td>是否使用默认的样式</td>
</tr>
<tr>
<td>automaticMergeHead</td>
<td>true</td>
<td>自动合并头，头中相同的字段上下左右都会去尝试匹配</td>
</tr>
<tr>
<td>excludeColumnIndexes</td>
<td>空</td>
<td>需要排除对象中的index的数据</td>
</tr>
<tr>
<td>excludeColumnFieldNames</td>
<td>空</td>
<td>需要排除对象中的字段的数据</td>
</tr>
<tr>
<td>includeColumnIndexes</td>
<td>空</td>
<td>只要导出对象中的index的数据</td>
</tr>
<tr>
<td>includeColumnFieldNames</td>
<td>空</td>
<td>只要导出对象中的字段的数据</td>
</tr>
</tbody>
</table>
<h5 id="writeworkbook">WriteWorkbook</h5>
<p>设置方法如下，找不到参数的看下通用参数里面是否存在。</p>
<pre><code class="language-java"> EasyExcel.write(fileName, DemoData.class)
            // 在 write 方法之后， 在 sheet方法之前都是设置WriteWorkbook的参数
            .sheet(&quot;模板&quot;)
            .doWrite(() -&gt; {
                // 分页查询数据
                return data();
            });
</code></pre>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>excelType</td>
<td>空</td>
<td>当前excel的类型,支持XLS、XLSX、CSV</td>
</tr>
<tr>
<td>outputStream</td>
<td>空</td>
<td>与<code>file</code>二选一。写入文件的流</td>
</tr>
<tr>
<td>file</td>
<td>空</td>
<td>与<code>outputStream</code>二选一。写入的文件</td>
</tr>
<tr>
<td>templateInputStream</td>
<td>空</td>
<td>模板的文件流</td>
</tr>
<tr>
<td>templateFile</td>
<td>空</td>
<td>模板文件</td>
</tr>
<tr>
<td>charset</td>
<td>Charset#defaultCharset</td>
<td>只有csv文件有用，写入文件的时候使用的编码</td>
</tr>
<tr>
<td>autoCloseStream</td>
<td>true</td>
<td>自动关闭写入的流。</td>
</tr>
<tr>
<td>password</td>
<td>空</td>
<td>读取文件的密码</td>
</tr>
<tr>
<td>inMemory</td>
<td>false</td>
<td>是否在内存处理，默认会生成临时文件以节约内存。内存模式效率会更好，但是容易OOM</td>
</tr>
<tr>
<td>writeExcelOnException</td>
<td>false</td>
<td>写入过程中抛出异常了，是否尝试把数据写入到excel</td>
</tr>
</tbody>
</table>
<h5 id="writesheet">WriteSheet</h5>
<p>设置方法如下，找不到参数的看下通用参数里面是否存在。</p>
<pre><code class="language-java"> EasyExcel.write(fileName, DemoData.class)
            .sheet(&quot;模板&quot;)
             // 在 sheet 方法之后， 在 doWrite方法之前都是设置WriteSheet的参数
            .doWrite(() -&gt; {
                // 分页查询数据
                return data();
            });
</code></pre>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sheetNo</td>
<td>0</td>
<td>需要写入的编码</td>
</tr>
<tr>
<td>sheetName</td>
<td>空</td>
<td>需要些的Sheet名称，默认同<code>sheetNo</code></td>
</tr>
</tbody>
</table>
<h5 id="writetable">WriteTable</h5>
<p>设置方法如下，找不到参数的看下通用参数里面是否存在。</p>
<pre><code class="language-java">        EasyExcel.write(fileName, DemoData.class)
            .sheet(&quot;模板&quot;)
            .table()
            // 在 table 方法之后， 在 doWrite方法之前都是设置WriteTable的参数
            .doWrite(() -&gt; {
                // 分页查询数据
                return data();
            });
</code></pre>
<table>
<thead>
<tr>
<th>名称</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableNo</td>
<td>0</td>
<td>需要写入的编码</td>
</tr>
</tbody>
</table>
<pre><code class="language-java">&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;
    &lt;version&gt;3.1.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="webtest">WebTest</h3>
<pre><code class="language-java">import java.io.IOException;
import java.net.URLEncoder;
import java.util.Date;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletResponse;

import com.alibaba.excel.EasyExcel;
import com.alibaba.excel.util.ListUtils;
import com.alibaba.excel.util.MapUtils;
import com.alibaba.fastjson.JSON;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.multipart.MultipartFile;

/**
 * web读写案例
 *
 **/
@Controller
public class WebTest {

    @Autowired
    private UploadDAO uploadDAO;

    /**
     * 文件下载（失败了会返回一个有部分数据的Excel）
     * &lt;p&gt;
     * 1. 创建excel对应的实体对象 参照{@link DownloadData}
     * &lt;p&gt;
     * 2. 设置返回的 参数
     * &lt;p&gt;
     * 3. 直接写，这里注意，finish的时候会自动关闭OutputStream,当然你外面再关闭流问题不大
     */
    @GetMapping(&quot;download&quot;)
    public void download(HttpServletResponse response) throws IOException {
        // 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman
        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);
        response.setCharacterEncoding(&quot;utf-8&quot;);
        // 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系
        String fileName = URLEncoder.encode(&quot;测试&quot;, &quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);
        response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8''&quot; + fileName + &quot;.xlsx&quot;);

        EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet(&quot;模板&quot;).doWrite(data());
    }

    /**
     * 文件下载并且失败的时候返回json（默认失败了会返回一个有部分数据的Excel）
     *
     * @since 2.1.1
     */
    @GetMapping(&quot;downloadFailedUsingJson&quot;)
    public void downloadFailedUsingJson(HttpServletResponse response) throws IOException {
        // 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman
        try {
            response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);
            response.setCharacterEncoding(&quot;utf-8&quot;);
            // 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系
            String fileName = URLEncoder.encode(&quot;测试&quot;, &quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);
            response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8''&quot; + fileName + &quot;.xlsx&quot;);
            // 这里需要设置不关闭流
            EasyExcel.write(response.getOutputStream(), DownloadData.class).autoCloseStream(Boolean.FALSE).sheet(&quot;模板&quot;)
                .doWrite(data());
        } catch (Exception e) {
            // 重置response
            response.reset();
            response.setContentType(&quot;application/json&quot;);
            response.setCharacterEncoding(&quot;utf-8&quot;);
            Map&lt;String, String&gt; map = MapUtils.newHashMap();
            map.put(&quot;status&quot;, &quot;failure&quot;);
            map.put(&quot;message&quot;, &quot;下载文件失败&quot; + e.getMessage());
            response.getWriter().println(JSON.toJSONString(map));
        }
    }

    /**
     * 文件上传
     * &lt;p&gt;
     * 1. 创建excel对应的实体对象 参照{@link UploadData}
     * &lt;p&gt;
     * 2. 由于默认一行行的读取excel，所以需要创建excel一行一行的回调监听器，参照{@link UploadDataListener}
     * &lt;p&gt;
     * 3. 直接读即可
     */
    @PostMapping(&quot;upload&quot;)
    @ResponseBody
    public String upload(MultipartFile file) throws IOException {
        EasyExcel.read(file.getInputStream(), UploadData.class, new UploadDataListener(uploadDAO)).sheet().doRead();
        return &quot;success&quot;;
    }

    private List&lt;DownloadData&gt; data() {
        List&lt;DownloadData&gt; list = ListUtils.newArrayList();
        for (int i = 0; i &lt; 10; i++) {
            DownloadData data = new DownloadData();
            data.setString(&quot;字符串&quot; + 0);
            data.setDate(new Date());
            data.setDoubleData(0.56);
            list.add(data);
        }
        return list;
    }
}
</code></pre>
<h3 id="downloaddata">DownloadData</h3>
<pre><code class="language-java">import java.util.Date;

import com.alibaba.excel.annotation.ExcelProperty;

import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.Setter;

/**
 * 基础数据类
 *
 **/
@Getter
@Setter
@EqualsAndHashCode
public class DownloadData {
    @ExcelProperty(&quot;字符串标题&quot;)
    private String string;
    @ExcelProperty(&quot;日期标题&quot;)
    private Date date;
    @ExcelProperty(&quot;数字标题&quot;)
    private Double doubleData;
}
</code></pre>
<h3 id="uploaddao">UploadDAO</h3>
<pre><code class="language-java">import java.util.List;

import org.springframework.stereotype.Repository;

/**
 * 假设这个是你的DAO存储。当然还要这个类让spring管理，当然你不用需要存储，也不需要这个类。
 *
 **/
@Repository
public class UploadDAO {

    public void save(List&lt;UploadData&gt; list) {
        // 如果是mybatis,尽量别直接调用多次insert,自己写一个mapper里面新增一个方法batchInsert,所有数据一次性插入
    }
}
</code></pre>
<h3 id="uploaddata">UploadData</h3>
<pre><code class="language-java">import java.util.Date;

import lombok.EqualsAndHashCode;
import lombok.Getter;
import lombok.Setter;

/**
 * 基础数据类
 *
 **/
@Getter
@Setter
@EqualsAndHashCode
public class UploadData {
    private String string;
    private Date date;
    private Double doubleData;
}
</code></pre>
<h3 id="uploaddatalistener">UploadDataListener</h3>
<pre><code class="language-java">import java.util.List;

import com.alibaba.excel.context.AnalysisContext;
import com.alibaba.excel.read.listener.ReadListener;
import com.alibaba.excel.util.ListUtils;
import com.alibaba.fastjson.JSON;

import lombok.extern.slf4j.Slf4j;

/**
 * 模板的读取类
 *
 */
// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去
@Slf4j
public class UploadDataListener implements ReadListener&lt;UploadData&gt; {
    /**
     * 每隔5条存储数据库，实际使用中可以100条，然后清理list ，方便内存回收
     */
    private static final int BATCH_COUNT = 5;
    private List&lt;UploadData&gt; cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);
    /**
     * 假设这个是一个DAO，当然有业务逻辑这个也可以是一个service。当然如果不用存储这个对象没用。
     */
    private UploadDAO uploadDAO;

    public UploadDataListener() {
        // 这里是demo，所以随便new一个。实际使用如果到了spring,请使用下面的有参构造函数
        uploadDAO = new UploadDAO();
    }

    /**
     * 如果使用了spring,请使用这个构造方法。每次创建Listener的时候需要把spring管理的类传进来
     *
     * @param uploadDAO
     */
    public UploadDataListener(UploadDAO uploadDAO) {
        this.uploadDAO = uploadDAO;
    }

    /**
     * 这个每一条数据解析都会来调用
     *
     * @param data    one row value. Is is same as {@link AnalysisContext#readRowHolder()}
     * @param context
     */
    @Override
    public void invoke(UploadData data, AnalysisContext context) {
        log.info(&quot;解析到一条数据:{}&quot;, JSON.toJSONString(data));
        cachedDataList.add(data);
        // 达到BATCH_COUNT了，需要去存储一次数据库，防止数据几万条数据在内存，容易OOM
        if (cachedDataList.size() &gt;= BATCH_COUNT) {
            saveData();
            // 存储完成清理 list
            cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);
        }
    }

    /**
     * 所有数据解析完成了 都会来调用
     *
     * @param context
     */
    @Override
    public void doAfterAllAnalysed(AnalysisContext context) {
        // 这里也要保存数据，确保最后遗留的数据也存储到数据库
        saveData();
        log.info(&quot;所有数据解析完成！&quot;);
    }

    /**
     * 加上存储数据库
     */
    private void saveData() {
        log.info(&quot;{}条数据，开始存储数据库！&quot;, cachedDataList.size());
        uploadDAO.save(cachedDataList);
        log.info(&quot;存储数据库成功！&quot;);
    }
}
</code></pre>
<h3 id="excelutil">ExcelUtil</h3>
<pre><code class="language-java">import com.alibaba.excel.EasyExcelFactory;
import com.alibaba.excel.ExcelWriter;
import com.alibaba.excel.context.AnalysisContext;
import com.alibaba.excel.event.AnalysisEventListener;
import com.alibaba.excel.metadata.BaseRowModel;
import com.alibaba.excel.metadata.Sheet;
import lombok.Data;
import lombok.Getter;
import lombok.Setter;
import lombok.extern.slf4j.Slf4j;
import org.springframework.util.CollectionUtils;
import org.springframework.util.StringUtils;

import java.io.*;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

@Slf4j
public class ExcelUtil {

   private static Sheet initSheet;

   static {
      initSheet = new Sheet(1, 0);
      initSheet.setSheetName(&quot;sheet&quot;);
      //设置自适应宽度
      initSheet.setAutoWidth(Boolean.TRUE);
   }

   /**
    * 读取少于1000行数据
    * @param filePath 文件绝对路径
    * @return
    */
   public static List&lt;Object&gt; readLessThan1000Row(String filePath){
      return readLessThan1000RowBySheet(filePath,null);
   }

   /**
    * 读小于1000行数据, 带样式
    * filePath 文件绝对路径
    * initSheet ：
    *      sheetNo: sheet页码，默认为1
    *      headLineMun: 从第几行开始读取数据，默认为0, 表示从第一行开始读取
    *      clazz: 返回数据List&lt;Object&gt; 中Object的类名
    */
   public static List&lt;Object&gt; readLessThan1000RowBySheet(String filePath, Sheet sheet){
      if(!StringUtils.hasText(filePath)){
         return null;
      }

      sheet = sheet != null ? sheet : initSheet;

      InputStream fileStream = null;
      try {
         fileStream = new FileInputStream(filePath);
         return EasyExcelFactory.read(fileStream, sheet);
      } catch (FileNotFoundException e) {
         log.info(&quot;找不到文件或文件路径错误, 文件：{}&quot;, filePath);
      }finally {
         try {
            if(fileStream != null){
               fileStream.close();
            }
         } catch (IOException e) {
            log.info(&quot;excel文件读取失败, 失败原因：{}&quot;, e);
         }
      }
      return null;
   }

   /**
    * 读大于1000行数据
    * @param filePath 文件觉得路径
    * @return
    */
   public static List&lt;Object&gt; readMoreThan1000Row(String filePath){
      return readMoreThan1000RowBySheet(filePath,null);
   }

   /**
    * 读大于1000行数据, 带样式
    * @param filePath 文件觉得路径
    * @return
    */
   public static List&lt;Object&gt; readMoreThan1000RowBySheet(String filePath, Sheet sheet){
      if(!StringUtils.hasText(filePath)){
         return null;
      }

      sheet = sheet != null ? sheet : initSheet;

      InputStream fileStream = null;
      try {
         fileStream = new FileInputStream(filePath);
         ExcelListener excelListener = new ExcelListener();
         EasyExcelFactory.readBySax(fileStream, sheet, excelListener);
         return excelListener.getDatas();
      } catch (FileNotFoundException e) {
         log.error(&quot;找不到文件或文件路径错误, 文件：{}&quot;, filePath);
      }finally {
         try {
            if(fileStream != null){
               fileStream.close();
            }
         } catch (IOException e) {
            log.error(&quot;excel文件读取失败, 失败原因：{}&quot;, e);
         }
      }
      return null;
   }

   /**
    * 生成excle
    * @param filePath  绝对路径, 如：/home/chenmingjian/Downloads/aaa.xlsx
    * @param data 数据源
    * @param head 表头
    */
   public static void writeBySimple(String filePath, List&lt;List&lt;Object&gt;&gt; data, List&lt;String&gt; head){
      writeSimpleBySheet(filePath,data,head,null);
   }

   /**
    * 生成excle
    * @param filePath 绝对路径, 如：/home/chenmingjian/Downloads/aaa.xlsx
    * @param data 数据源
    * @param sheet excle页面样式
    * @param head 表头
    */
   public static void writeSimpleBySheet(String filePath, List&lt;List&lt;Object&gt;&gt; data, List&lt;String&gt; head, Sheet sheet){
      sheet = (sheet != null) ? sheet : initSheet;

      if(head != null){
         List&lt;List&lt;String&gt;&gt; list = new ArrayList&lt;&gt;();
         head.forEach(h -&gt; list.add(Collections.singletonList(h)));
         sheet.setHead(list);
      }

      OutputStream outputStream = null;
      ExcelWriter writer = null;
      try {
         outputStream = new FileOutputStream(filePath);
         writer = EasyExcelFactory.getWriter(outputStream);
         writer.write1(data,sheet);
      } catch (FileNotFoundException e) {
         log.error(&quot;找不到文件或文件路径错误, 文件：{}&quot;, filePath);
      }finally {
         try {
            if(writer != null){
               writer.finish();
            }

            if(outputStream != null){
               outputStream.close();
            }

         } catch (IOException e) {
            log.error(&quot;excel文件导出失败, 失败原因：{}&quot;, e);
         }
      }

   }

   /**
    * 生成excle
    * @param filePath 绝对路径, 如：/home/chenmingjian/Downloads/aaa.xlsx
    * @param data 数据源
    */
   public static void writeWithTemplate(String filePath, List&lt;? extends BaseRowModel&gt; data){
      writeWithTemplateAndSheet(filePath,data,null);
   }

   /**
    * 生成excle
    * @param filePath 绝对路径, 如：/home/chenmingjian/Downloads/aaa.xlsx
    * @param data 数据源
    * @param sheet excle页面样式
    */
   public static void writeWithTemplateAndSheet(String filePath, List&lt;? extends BaseRowModel&gt; data, Sheet sheet){
      if(CollectionUtils.isEmpty(data)){
         return;
      }

      sheet = (sheet != null) ? sheet : initSheet;
      sheet.setClazz(data.get(0).getClass());

      OutputStream outputStream = null;
      ExcelWriter writer = null;
      try {
         outputStream = new FileOutputStream(filePath);
         writer = EasyExcelFactory.getWriter(outputStream);
         writer.write(data,sheet);
      } catch (FileNotFoundException e) {
         log.error(&quot;找不到文件或文件路径错误, 文件：{}&quot;, filePath);
      }finally {
         try {
            if(writer != null){
               writer.finish();
            }

            if(outputStream != null){
               outputStream.close();
            }
         } catch (IOException e) {
            log.error(&quot;excel文件导出失败, 失败原因：{}&quot;, e);
         }
      }

   }

   /**
    * 生成多Sheet的excle
    * @param filePath 绝对路径, 如：/home/chenmingjian/Downloads/aaa.xlsx
    * @param multipleSheelPropetys
    */
   public static void writeWithMultipleSheel(String filePath,List&lt;MultipleSheelPropety&gt; multipleSheelPropetys){
      if(CollectionUtils.isEmpty(multipleSheelPropetys)){
         return;
      }

      OutputStream outputStream = null;
      ExcelWriter writer = null;
      try {
         outputStream = new FileOutputStream(filePath);
         writer = EasyExcelFactory.getWriter(outputStream);
         for (MultipleSheelPropety multipleSheelPropety : multipleSheelPropetys) {
            Sheet sheet = multipleSheelPropety.getSheet() != null ? multipleSheelPropety.getSheet() : initSheet;
            if(!CollectionUtils.isEmpty(multipleSheelPropety.getData())){
               sheet.setClazz(multipleSheelPropety.getData().get(0).getClass());
            }
            writer.write(multipleSheelPropety.getData(), sheet);
         }

      } catch (FileNotFoundException e) {
         log.error(&quot;找不到文件或文件路径错误, 文件：{}&quot;, filePath);
      }finally {
         try {
            if(writer != null){
               writer.finish();
            }

            if(outputStream != null){
               outputStream.close();
            }
         } catch (IOException e) {
            log.error(&quot;excel文件导出失败, 失败原因：{}&quot;, e);
         }
      }

   }


   /*********************匿名内部类开始，可以提取出去******************************/

   @Data
   public static class MultipleSheelPropety{

      private List&lt;? extends BaseRowModel&gt; data;

      private Sheet sheet;
   }

   /**
    * 解析监听器，
    * 每解析一行会回调invoke()方法。
    * 整个excel解析结束会执行doAfterAllAnalysed()方法
    */
   @Getter
   @Setter
   public static class ExcelListener extends AnalysisEventListener {

      private List&lt;Object&gt; datas = new ArrayList&lt;&gt;();

      /**
       * 逐行解析
       * object : 当前行的数据
       */
      @Override
      public void invoke(Object object, AnalysisContext context) {
         //当前行
         // context.getCurrentRowNum()
         if (object != null) {
            datas.add(object);
         }
      }


      /**
       * 解析完所有数据后会调用该方法
       */
      @Override
      public void doAfterAllAnalysed(AnalysisContext context) {
         //解析结束销毁不用的资源
      }

   }

   /************************匿名内部类结束，可以提取出去***************************/

}
</code></pre>

          <div class="toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E8%AF%BBexcel">读Excel</a>
<ul>
<li><a href="#%E6%B3%A8%E8%A7%A3">注解</a>
<ul>
<li><a href="#excelproperty"><code>ExcelProperty</code></a></li>
<li><a href="#excelignore"><code>ExcelIgnore</code></a></li>
<li><a href="#excelignoreunannotated"><code>ExcelIgnoreUnannotated</code></a></li>
<li><a href="#datetimeformat"><code>DateTimeFormat</code></a></li>
<li><a href="#numberformat"><code>NumberFormat</code></a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E6%95%B0">参数</a>
<ul>
<li><a href="#%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D">概念介绍</a></li>
<li><a href="#%E9%80%9A%E7%94%A8%E5%8F%82%E6%95%B0">通用参数</a></li>
<li><a href="#readworkbook">ReadWorkbook</a></li>
<li><a href="#readsheet">ReadSheet</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%86%99excel">写Excel</a>
<ul>
<li><a href="#%E6%B3%A8%E8%A7%A3-2">注解</a>
<ul>
<li><a href="#excelproperty-2"><code>ExcelProperty</code></a></li>
<li><a href="#excelignore-2"><code>ExcelIgnore</code></a></li>
<li><a href="#excelignoreunannotated-2"><code>ExcelIgnoreUnannotated</code></a></li>
<li><a href="#datetimeformat-2"><code>DateTimeFormat</code></a></li>
<li><a href="#numberformat-2"><code>NumberFormat</code></a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E6%95%B0-2">参数</a>
<ul>
<li><a href="#%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D-2">概念介绍</a></li>
<li><a href="#%E9%80%9A%E7%94%A8%E5%8F%82%E6%95%B0-2">通用参数</a></li>
<li><a href="#writeworkbook">WriteWorkbook</a></li>
<li><a href="#writesheet">WriteSheet</a></li>
<li><a href="#writetable">WriteTable</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#webtest">WebTest</a></li>
<li><a href="#downloaddata">DownloadData</a></li>
<li><a href="#uploaddao">UploadDAO</a></li>
<li><a href="#uploaddata">UploadData</a></li>
<li><a href="#uploaddatalistener">UploadDataListener</a></li>
<li><a href="#excelutil">ExcelUtil</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
          
              <hr />
            
          
            
            <p class="next-post">上一篇：
                <a href="https://tinaxiawuhao.github.io/post/MKTk7DnaM/">
                  <span class="post-title">
                    ES6新语法&rarr;
                  </span>
                </a>
              </p>
            
          
            
           <p class="prev-post">下一篇：
                 <a href="https://tinaxiawuhao.github.io/post/DyzAzkEVU/">
                   <span class="post-title">
                     消息队列选型&rarr;
                   </span>
                 </a>
               </p>
          
          <div class="comment" style="text-align: center;">
            

            
            
          </div>
        </div>
      </div>
  </article>
  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            
            
            <li class="list-inline-item">
              <a href="https://github.com/tinaxiawuhao" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            
              
            
              
            
              
            
              
            
              
            
              
            
              
              <!-- <li class="list-inline-item">
              <a href="https://tinaxiawuhao.github.io/atom.xml" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                </span>
              </a>
              </li> -->
          </ul>
          <p class="copyright text-muted">Copyright &copy;<span>tianxia</span><br><a href="https://github.com/getgridea/gridea" class="Themeinfo">Powered by Gridea</a></p>
        </div>
      </div>
    </div>
   </footer>
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <!-- <script src="https://tinaxiawuhao.github.io/media/scripts/bootstrap.bundle.min.js"></script> -->
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.jsdelivr.net/gh/Alanrk/clean-cdn@1.0/scripts/clean-blog.min.js"></script>
  <!-- <script src="https://tinaxiawuhao.github.io/media/scripts/clean-blog.min.js"></script> -->
  <style type="text/css">a.back_to_top{text-decoration:none;position:fixed;bottom:40px;right:30px;background:#f0f0f0;height:40px;width:40px;border-radius:50%;line-height:36px;font-size:18px;text-align:center;transition-duration:.5s;transition-propety:background-color;display:none}a.back_to_top span{color:#888}a.back_to_top:hover{cursor:pointer;background:#dfdfdf}a.back_to_top:hover span{color:#555}@media print,screen and(max-width:580px){.back_to_top{display:none!important}}</style>
<a id="back_to_top" href="#" class="back_to_top">
  <span>▲</span></a>
<script>$(document).ready((function(_this) {
    return function() {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function() {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block')
          } else {
            return bt.css('display', 'none')
          }
        });
        return bt.click(function() {
          $('body,html').animate({
            scrollTop: 0
          },
          800);
          return false
        })
      }
    }
  })(this));</script>
  
  <div id="landlord-parent">
    <div id="landlord">
        <div class="message" style="opacity:0"></div>
        <canvas id="live2d" width="240" height="250" class="live2d"></canvas>
    </div>
</div>

<script type="text/javascript">
    if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)) {
        //移动端
        console.log("------ 移动端");
    } else {
        console.log("------ PC端 " + navigator.userAgent);

        addScript("https://cdn.jsdelivr.net/gh/850552586/ericamcdn@0.1/js/live2d.js", () => {
            // 加载完成后再loadlive2d
            loadlive2d("live2d", "https://tinaxiawuhao.github.io/media/live2d/assets/tororo.model.json");
        });

        var home_Path = "https://tinaxiawuhao.github.io/";
        addScript("https://tinaxiawuhao.github.io/media/live2d/js/message.js", () => { });
    }

    // 插入js文件，完成后callback
    function addScript(jsfile, callback) {
        var landlord_parent = document.getElementById("landlord-parent");
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = jsfile;
        landlord_parent.appendChild(script);
        script.onload = script.onreadystatechange = function () {
            if (!this.readyState || this.readyState === "loaded" || this.readyState === "complete") {
                script.onload = script.onreadystatechange = null;
                if (callback && typeof callback == "function") {
                    callback(); //window[callback]();如果传递字符串过来 调用window['函数名']() 调用方法
                }
            }
        };
    }
</script>
  
  <script src="https://tinaxiawuhao.github.io/media/scripts/tocScript.js"></script>
</body>

</html>